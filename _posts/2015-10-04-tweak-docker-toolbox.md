---
layout: post
title:  "Оптимизируем Docker Toolbox"
date:   2015-10-04 23:06:00 +0300
categories: Obvious
---

Как оказалось, по умолчанию Docker Toolbox создает Docker VM с урезанными настройками. В частности виртуалке лоступно только 1 (!) ядро процессора. И это в эпоху много поточных приложений, когда даже дешевый смартфон имеет 4 ядра.

![Доступно 1 ядро](/files/tweak-docker-toolbox/default.png "Дефолтные настройки Docker VM")

Для эксперимента решил сравнить как скажется увеличение доступных ядер на производительность Docker VM. Для этого воспользовался контейнером с редисом где запустил стандартный бенчмарк. В итоге получил 2-х кратный прирост производительности. По всей видимомсти по умолчанию Docker VM использует только одно ядро и редис с бенчмарком начинают конкурировать за ресурсы процессора. Увеличение доступных ядер позволяет приложениям в контейнере выполняться параллельно. Вот что у меня получилось:

![Почти 2-х кратный прирост производительности](/files/tweak-docker-toolbox/raw.png "Сравнение производительности Redis 2.8 в 1-но и 4-х поточной Docker VM")

"Нормализованные" результаты:

![Почти 2-х кратный прирост производительности](/files/tweak-docker-toolbox/norm.png "Нормализаванное сравнение производительности Redis 2.8 в 1-но и 4-х поточной Docker VM")

P.S. Файлы результатов тестов:

1. [1 ядро](/files/tweak-docker-toolbox/redis-benchmark-2.8-docker-1-thread.txt)
2. [4 ядра](/files/tweak-docker-toolbox/redis-benchmark-2.8-docker-4-thread.txt)
3. [Windows 10](/files/tweak-docker-toolbox/redis-benchmark-2.8-win.txt)